<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>blogs</title>
    <meta name="description" content="Vuepress blog">
    
    
    <link rel="preload" href="/blogs/assets/css/0.styles.29f04c96.css" as="style"><link rel="preload" href="/blogs/assets/js/app.9a0a74d6.js" as="script"><link rel="preload" href="/blogs/assets/js/2.b7bf5e5c.js" as="script"><link rel="preload" href="/blogs/assets/js/18.1ddbfcf7.js" as="script"><link rel="preload" href="/blogs/assets/js/4.98ac330c.js" as="script"><link rel="prefetch" href="/blogs/assets/js/10.1cfa02d5.js"><link rel="prefetch" href="/blogs/assets/js/11.f03f91df.js"><link rel="prefetch" href="/blogs/assets/js/12.c274e980.js"><link rel="prefetch" href="/blogs/assets/js/13.17da97f4.js"><link rel="prefetch" href="/blogs/assets/js/14.9caa2607.js"><link rel="prefetch" href="/blogs/assets/js/15.a535c9aa.js"><link rel="prefetch" href="/blogs/assets/js/16.e8afe5b2.js"><link rel="prefetch" href="/blogs/assets/js/17.f1b71087.js"><link rel="prefetch" href="/blogs/assets/js/19.f77ae857.js"><link rel="prefetch" href="/blogs/assets/js/3.12abdd30.js"><link rel="prefetch" href="/blogs/assets/js/5.80d46032.js"><link rel="prefetch" href="/blogs/assets/js/6.43976944.js"><link rel="prefetch" href="/blogs/assets/js/7.39543e83.js"><link rel="prefetch" href="/blogs/assets/js/8.4dfc055b.js"><link rel="prefetch" href="/blogs/assets/js/9.c12fe9c3.js">
    <link rel="stylesheet" href="/blogs/assets/css/0.styles.29f04c96.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blogs/" class="home-link router-link-active"><img src="./logo.jpg" alt="blogs" class="logo"> <span class="site-name can-hide">blogs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blogs/home.html" class="nav-link">web开发</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架" class="dropdown-title"><span class="title">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/vue/" class="nav-link router-link-active">vue</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/" class="nav-link">react</a></li><li class="dropdown-item"><!----> <a href="/blogs/miniprogram/" class="nav-link">微信小程序</a></li></ul></div></div> <a href="https://github.com/giserman001/blogs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blogs/home.html" class="nav-link">web开发</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架" class="dropdown-title"><span class="title">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/vue/" class="nav-link router-link-active">vue</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/" class="nav-link">react</a></li><li class="dropdown-item"><!----> <a href="/blogs/miniprogram/" class="nav-link">微信小程序</a></li></ul></div></div> <a href="https://github.com/giserman001/blogs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/blogs/vue/" class="sidebar-link">web开发总结</a></li><li><a href="/blogs/vue/vue_ts.html" class="active sidebar-link">Vue + TS 开发应用</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blogs/vue/vue_optimize.html" class="sidebar-link">vue优化技巧</a></li><li><a href="/blogs/vue/vue_auth_manage.html" class="sidebar-link">vue权限菜单及按钮权限</a></li><li><a href="/blogs/vue/vue_JWT.html" class="sidebar-link">vue里JWT认证</a></li><li><a href="/blogs/vue/vue_render_jsx.html" class="sidebar-link">vue里render函数之JSX应用</a></li><li><a href="/blogs/vue/vue_module_communicate.html" class="sidebar-link">Vue组件间通信方式</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>使用vue-cli3创建项目，增加TypeScript</p> <div class="language- extra-class"><pre class="language-text"><code> (*) Babel
 (*) TypeScript
 ( ) Progressive Web App (PWA) Support
 (*) Router
 (*) Vuex
 (*) CSS Pre-processors
 (*) Linter / Formatter
</code></pre></div><blockquote><p>使用less和tslint即可</p></blockquote> <p>这里你会看到和普通生成js的项目有些不同</p> <ol><li>shims-tsx.d.ts，允许你以.tsx结尾的文件，在Vue项目中编写jsx代码</li> <li>shims-vue.d.ts TypeScript识别.vue 文件</li></ol> <h3 id="一-更新ts路由文件"><a href="#一-更新ts路由文件" class="header-anchor">#</a> 一.更新ts路由文件</h3> <div class="language- extra-class"><pre class="language-text"><code>import Vue from 'vue';
import Router from 'vue-router';
import Todo from './views/Todo.vue';
Vue.use(Router);export default new Router({
  mode: 'history',
  base: process.env.BASE_URL,
  routes: [
    {
      path: '/',
      name: 'todo',
      component: Todo, // 访问/ 的时候显示todo组件
    },
    {
      path: '/list', 
      name: 'list', // 访问/list时显示 列表组件
      component: () =&gt; import(/* webpackChunkName: &quot;List&quot; */ './views/List.vue'),
    },
  ],});
</code></pre></div><h3 id="二-在components下新增todo-vue"><a href="#二-在components下新增todo-vue" class="header-anchor">#</a> 二.在components下新增Todo.vue</h3> <div class="language- extra-class"><pre class="language-text"><code>&lt;template&gt;
  &lt;div&gt;
    &lt;ul&gt;
      &lt;li v-for=&quot;(item,index) in lists&quot; :key=&quot;index&quot;&gt;
        &lt;span v-if=&quot;currentIndex !== index&quot;&gt;{{item.text}}&lt;/span&gt;
        &lt;input type=&quot;text&quot; v-else /&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
  &lt;/template&gt;
  &lt;script lang=&quot;ts&quot;&gt;
  // Component来注册组件
  import { Component, Vue } from &quot;vue-property-decorator&quot;;
@Component
export default class Todo extends Vue {
  public currentIndex = -1;
  public lists = [ // 声明数据列表
    {
      text: &quot;睡觉 呼呼~~~&quot;,
      complete: false
    },
    {
      text: &quot;玩游戏 呼呼~~~&quot;,
      complete: false
    }
  ];}
&lt;/script&gt;
</code></pre></div><h3 id="三-jsx编写todo-item组件"><a href="#三-jsx编写todo-item组件" class="header-anchor">#</a> 三.JSX编写todo-item组件</h3> <h4 id="属性传递-prop"><a href="#属性传递-prop" class="header-anchor">#</a> 属性传递(@Prop)</h4> <div class="language- extra-class"><pre class="language-text"><code>import { Component, Prop, Vue } from 'vue-property-decorator';
interface Item {
  text: string;
  complete: boolean;
}
@Component
export default class TodoItem extends Vue {
  // 属性校验
  @Prop(Object) public item!: Item; // 循环的每一项
  @Prop(Number) public index!: number; // 当前循环的索引
  @Prop(Number) public currentIndex!: number; // 默认哪一项是当前编辑状态
  public render() { // 组件需要拥有render方法
    return &lt;div&gt;
      {this.index !== this.currentIndex ? &lt;span&gt;{this.item.text}&lt;/span&gt; : &lt;input /&gt;}
    &lt;/div&gt;;
  }
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>// 在Todo中引入TodoItem组件
&lt;li v-for=&quot;(item,index) in lists&quot; :key=&quot;index&quot;&gt;
    &lt;TodoItem :item=&quot;item&quot; :index=&quot;index&quot; :currentIndex=&quot;currentIndex&quot;&gt;&lt;/TodoItem&gt;&lt;/li&gt;
</code></pre></div><h3 id="四-引入elementui"><a href="#四-引入elementui" class="header-anchor">#</a> 四.引入elementUI</h3> <div class="language- extra-class"><pre class="language-text"><code>// 在main.js中引入elementUI
import ElementUI from 'element-ui';import 'element-ui/lib/theme-chalk/index.css';
Vue.use(ElementUI);
</code></pre></div><h3 id="五-使用elementui"><a href="#五-使用elementui" class="header-anchor">#</a> 五.使用elementUI</h3> <div class="language- extra-class"><pre class="language-text"><code>public editingContent = ''; // 编辑的值
  public handleChange(value: string) {
    this.editingContent = value;
  }
  protected render() {
    return &lt;li&gt;
      {this.index === this.currentIndex ?
        &lt;div&gt;
          &lt;el-input value={this.editingContent} size='small' on-input={this.handleChange} style={{ width: '200px' }}&gt;&lt;/el-input&gt;
          &lt;el-button type='primary' size='small'  icon='el-icon-check'&gt;&lt;/el-button&gt;
          &lt;el-button type='danger' size='small' icon='el-icon-close'&gt;&lt;/el-button&gt;
        &lt;/div&gt;
        : &lt;div&gt;
          &lt;span class='content'&gt;{this.item.text}&lt;/span&gt;
          &lt;el-button type='default' size='small' icon='el-icon-edit'&gt;&lt;/el-button&gt;
        &lt;/div&gt;
      }
    &lt;/li &gt;;
  } 
</code></pre></div><h3 id="六-组件间通信-emit"><a href="#六-组件间通信-emit" class="header-anchor">#</a> 六.组件间通信(@Emit)</h3> <h4 id="实现编辑功能"><a href="#实现编辑功能" class="header-anchor">#</a> 实现编辑功能</h4> <div class="language- extra-class"><pre class="language-text"><code>&lt;TodoItem
  v-for=&quot;(item,index) in lists&quot;
  :key=&quot;index&quot;
  :item=&quot;item&quot;
  :index=&quot;index&quot;
  :currentIndex=&quot;currentIndex&quot;
  @edit=&quot;edit&quot; // 像子组件传递edit事件&gt;
&lt;/TodoItem&gt;
  public edit(index: number) {
    this.currentIndex = index;}
</code></pre></div><p>子组件触发父组件的方法</p> <div class="language- extra-class"><pre class="language-text"><code>public edit() {
    this.$emit('edit', this.index);}&lt;el-button type='primary' size='small' icon='el-icon-edit' on-click={this.edit}&gt;&lt;/el-button&gt;
</code></pre></div><p>可以使用装饰器</p> <div class="language- extra-class"><pre class="language-text"><code>import { Component, Prop, Vue, Emit } from 'vue-property-decorator';
@Emit('edit') // 如果发射的事件名和方法名相同，则可以省略
public edit() {
  return this.index; // 返回的结果或作为向上传递的内容
}
</code></pre></div><h4 id="实现保存功能"><a href="#实现保存功能" class="header-anchor">#</a> 实现保存功能</h4> <div class="language- extra-class"><pre class="language-text"><code>&lt;TodoItem
   v-for=&quot;(item,index) in lists&quot;
  :key=&quot;index&quot;
  :item=&quot;item&quot;
  :index=&quot;index&quot;
  :currentIndex=&quot;currentIndex&quot;
  @edit=&quot;edit&quot;
  @save=&quot;save&quot;
  @close=&quot;close&quot;&gt;&lt;/TodoItem&gt;
</code></pre></div><p>将save方法传递给子组件</p> <div class="language- extra-class"><pre class="language-text"><code>public save({index,content}:{index:number,content:string}){
    this.lists[index].text = content;
    this.close();
}
public close() {
  this.currentIndex = -1;
}
</code></pre></div><p>子组件调用save方法</p> <div class="language- extra-class"><pre class="language-text"><code>@Emit()
public save() {
  return {
    index: this.index,
    content: this.editingContent
  }
}
&lt;el-button type='primary' on-click={this.save} size='small' icon='el-icon-check'&gt;&lt;/el-button&gt;
</code></pre></div><h3 id="七-数据的监控-watch"><a href="#七-数据的监控-watch" class="header-anchor">#</a> 七.数据的监控(@Watch)</h3> <p>这里我们可以监控索引的变化</p> <div class="language- extra-class"><pre class="language-text"><code>import { Component, Prop, Vue, Emit, Watch } from 'vue-property-decorator';
@Watch('currentIndex')
public changeIndex() { // 索引变化讲内容赋予给当前编辑的内容
    this.editingContent = this.item.text;
}
</code></pre></div><h3 id="八-将数据迁移至vuex"><a href="#八-将数据迁移至vuex" class="header-anchor">#</a> 八.将数据迁移至vuex</h3> <div class="language- extra-class"><pre class="language-text"><code>import Vue from 'vue';import Vuex from 'vuex';
Vue.use(Vuex);export default new Vuex.Store({
  state: {
    list: [
      {
        text: '睡觉 呼呼~~~',
        complete: false,
      },
      {
        text: '玩游戏 呼呼~~~',
        complete: false,
      },
    ],
  },
  mutations: {
    updateList(state, { index, content }) {
      state.lists[index].text = content;
    }
  },});
</code></pre></div><h4 id="安装vuex-class"><a href="#安装vuex-class" class="header-anchor">#</a> 安装vuex-class</h4> <div class="language- extra-class"><pre class="language-text"><code>npm i vuex-class
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>import { State, Mutation } from &quot;vuex-class&quot;;
@State(&quot;lists&quot;) public lists!: Item[];
@Mutation(&quot;updateList&quot;)
public updateList!: (obj: IChangeItem) =&gt; void;public save(item: IChangeItem) {
    this.updateList(item); // 通过mutation更新状态
    this.close();
}
</code></pre></div> <div class="gitalk-container"><div id="gitalk-container"></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/giserman001/blogs/edit/master/docs/vue/vue_ts.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blogs/vue/" class="prev router-link-active">web开发总结</a></span> <span class="next"><a href="/blogs/vue/vue_optimize.html">vue优化技巧</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blogs/assets/js/app.9a0a74d6.js" defer></script><script src="/blogs/assets/js/2.b7bf5e5c.js" defer></script><script src="/blogs/assets/js/18.1ddbfcf7.js" defer></script><script src="/blogs/assets/js/4.98ac330c.js" defer></script>
  </body>
</html>
