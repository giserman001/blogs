<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue使用优化及使用技巧 | 清风拂林</title>
    <meta name="description" content="Vuepress blog">
    <meta name="generator" content="VuePress 1.3.1">
    
    
    <link rel="preload" href="https://lw68.top/blogs/assets/css/0.styles.e67da613.css" as="style"><link rel="preload" href="https://lw68.top/blogs/assets/js/app.a89d5e58.js" as="script"><link rel="preload" href="https://lw68.top/blogs/assets/js/2.d82e790e.js" as="script"><link rel="preload" href="https://lw68.top/blogs/assets/js/24.0c4df642.js" as="script"><link rel="preload" href="https://lw68.top/blogs/assets/js/13.210d011a.js" as="script"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/10.a22c268a.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/11.6f2aecdb.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/12.71733416.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/14.0f913f7b.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/15.bc8d19a9.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/16.30c8583f.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/17.32032192.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/18.582e9739.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/19.37c1e619.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/20.d010718f.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/21.72d5389b.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/22.2643326e.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/23.ab785e28.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/25.6ede6de6.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/26.59126a56.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/27.0a3ddc14.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/28.1fe652f9.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/29.b7f4eff6.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/3.15d04d8b.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/30.f080a630.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/31.6d5a7d9e.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/32.021b9a46.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/33.06b2ba63.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/34.d2ae8c1a.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/35.b22a8af2.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/36.d8afbced.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/37.19238c2b.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/38.3dea0c12.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/39.1d5a4338.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/4.d6503848.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/40.ff70c70e.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/41.56dff3f3.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/42.06dc4a8e.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/43.31dc0d03.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/44.32a75168.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/45.057062a2.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/46.8321aa6d.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/47.cbcf5ec0.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/48.433ab22a.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/49.117d98f2.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/5.a3788cce.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/50.9d78371a.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/51.b943c971.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/52.cadd552e.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/53.726dddb2.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/54.40cf41c6.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/55.49fbd50f.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/56.34e27983.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/57.a1d4cbac.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/6.49cbaff5.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/7.f818b1eb.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/8.ca73d522.js"><link rel="prefetch" href="https://lw68.top/blogs/assets/js/9.09bb3274.js">
    <link rel="stylesheet" href="https://lw68.top/blogs/assets/css/0.styles.e67da613.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="globalLayout"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blogs/" class="home-link router-link-active"><img src="./logo.jpg" alt="清风拂林" class="logo"> <span class="site-name can-hide">清风拂林</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blogs/article.html" class="nav-link">
  文章
</a></div><div class="nav-item"><a href="/blogs/friendLink.html" class="nav-link">
  友情链接
</a></div><div class="nav-item"><a href="/blogs/aboutMe.html" class="nav-link">
  关于作者
</a></div> <a href="https://github.com/giserman001/blogs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blogs/article.html" class="nav-link">
  文章
</a></div><div class="nav-item"><a href="/blogs/friendLink.html" class="nav-link">
  友情链接
</a></div><div class="nav-item"><a href="/blogs/aboutMe.html" class="nav-link">
  关于作者
</a></div> <a href="https://github.com/giserman001/blogs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue使用优化及使用技巧"><a href="#vue使用优化及使用技巧" class="header-anchor">#</a> vue使用优化及使用技巧</h1> <p></p><div class="table-of-contents"><ul><li><a href="#vue预渲染解决首页白屏和seo-npm-i-prerender-spa-plugin">vue预渲染解决首页白屏和SEO (npm i prerender-spa-plugin)</a></li><li><a href="#骨架屏加载-（npm-i-vue-skeleton-webpack-plugin）单页骨架屏-多页骨架屏（带路由）">骨架屏加载 （npm i vue-skeleton-webpack-plugin）单页骨架屏   多页骨架屏（带路由）</a></li><li><a href="#优化技巧">优化技巧</a></li><li><a href="#化繁为简的watch">化繁为简的Watch</a></li><li><a href="#一劳永逸的组件注册">一劳永逸的组件注册</a></li><li><a href="#无所不能的render函数">无所不能的render函数</a></li><li><a href="#无招胜有招的高阶组件">无招胜有招的高阶组件</a></li></ul></div><p></p> <h3 id="vue预渲染解决首页白屏和seo-npm-i-prerender-spa-plugin"><a href="#vue预渲染解决首页白屏和seo-npm-i-prerender-spa-plugin" class="header-anchor">#</a> vue预渲染解决首页白屏和SEO (npm i prerender-spa-plugin)</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install prerender<span class="token operator">-</span>spa<span class="token operator">-</span>plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>缺陷数据不够动态，可以使用ssr服务端渲染</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> PrerenderSPAPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'prerender-spa-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    configureWebpack<span class="token operator">:</span> <span class="token punctuation">{</span>
        plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">PrerenderSPAPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                staticDir<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                routes<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'/about'</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="骨架屏加载-（npm-i-vue-skeleton-webpack-plugin）单页骨架屏-多页骨架屏（带路由）"><a href="#骨架屏加载-（npm-i-vue-skeleton-webpack-plugin）单页骨架屏-多页骨架屏（带路由）" class="header-anchor">#</a> 骨架屏加载 （npm i vue-skeleton-webpack-plugin）单页骨架屏   多页骨架屏（带路由）</h3> <p>配置webpack插件 vue-skeleton-webpack-plugin</p> <ol><li>单页骨架屏幕</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Skeleton <span class="token keyword">from</span> <span class="token string">'./Skeleton.vue'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    components<span class="token operator">:</span> <span class="token punctuation">{</span>
        Skeleton<span class="token operator">:</span>Skeleton
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;Skeleton&gt;&lt;/Skeleton&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 骨架屏</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">SkeletonWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        webpackConfig<span class="token operator">:</span> <span class="token punctuation">{</span>
            entry<span class="token operator">:</span> <span class="token punctuation">{</span>
                app<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./src/entry-skeleton.js'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ol start="2"><li>带路由（多页）的骨架屏，编写skeleton.js文件</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Skeleton1 <span class="token keyword">from</span> <span class="token string">'./Skeleton1'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Skeleton2 <span class="token keyword">from</span> <span class="token string">'./Skeleton2'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
      Skeleton1<span class="token punctuation">,</span>
      Skeleton2
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div&gt;
      &lt;skeleton1 id=&quot;skeleton1&quot; style=&quot;display:none&quot;/&gt;
      &lt;skeleton2 id=&quot;skeleton2&quot; style=&quot;display:none&quot;/&gt;
    &lt;/div&gt;</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">SkeletonWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  webpackConfig<span class="token operator">:</span> <span class="token punctuation">{</span>
      entry<span class="token operator">:</span> <span class="token punctuation">{</span>
          app<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/skeleton.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  router<span class="token operator">:</span> <span class="token punctuation">{</span>
    mode<span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
    routes<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
        skeletonId<span class="token operator">:</span> <span class="token string">'skeleton1'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        path<span class="token operator">:</span> <span class="token string">'/about'</span><span class="token punctuation">,</span>
        skeletonId<span class="token operator">:</span> <span class="token string">'skeleton2'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  minimize<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  quiet<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="优化技巧"><a href="#优化技巧" class="header-anchor">#</a> 优化技巧</h3> <ul><li><p>服务端渲染（ssr）nuxt.js</p></li> <li><p>webpack优化</p> <ol><li><p>使用cdn 配合 externals配置</p></li> <li><p>使用多线程打包happypack</p></li> <li><p>提取公共模块webpack4---splitsChunks (webpack3用的是CommonsChunkPlugin插件)</p></li> <li><p>sourceMap配置</p></li></ol> <blockquote><p>配合使用webpack-bundle-analyzer分析打包后文件大小</p></blockquote></li> <li><p>data属性之定义响应式数据</p></li> <li><p>spa页面使用keep-alive缓存组件</p></li> <li><p>拆分组件: vue组件渲染是具体到组件的，如果组件拆分够细，那么数据变动，页面渲染也就具体到某一个组件</p></li> <li><p>v-if 具有阻断功能  尽量使用v-if 简单的显示隐藏就使用v-show</p></li> <li><p>key保持唯一性  尽量不要使用 索引做</p></li> <li><p>海量数据展示时，不需要响应，那么就使用Object.freeze去冻结，不去添加响应式 Object.defineProperty</p></li> <li><p>路由懒加载和异步加载</p></li> <li><p>尽量使用runtime运行时   （即.vue文件形式（webpack打包时进行编译）   而不是在vue实列里面写template模板(代码运行时进行编译，此时消耗性能)）</p></li> <li><p>数据持久化</p> <ol><li>页面刷新重新请求接口</li> <li>存入本地localstroage sessionstroage</li></ol> <blockquote><p>（使用插件：npm i vue-persist）</p></blockquote></li></ul> <h3 id="化繁为简的watch"><a href="#化繁为简的watch" class="header-anchor">#</a> 化繁为简的Watch</h3> <div class="custom-block tip"><p class="custom-block-title">场景还原</p> <p>组件创建的时候我们获取一次列表，同时监听input框，每当发生变化的时候重新获取一次筛选后的列表这个场景很常见，有没有办法优化一下呢？</p></div> <div class="language-js line-numbers-mode"><pre class="language-js"><code>created<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
watch<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function">searchInputValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>优化后</p></blockquote> <p>首先，在watch中，可以直接使用函数的字面量名称；其次，声明immediate:true表示创建组件时立马执行一次。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>watch<span class="token operator">:</span> <span class="token punctuation">{</span>
  searchInputValue<span class="token operator">:</span> <span class="token punctuation">{</span>
    handler<span class="token operator">:</span> <span class="token string">'getList'</span><span class="token punctuation">,</span>
    immediate<span class="token operator">:</span><span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="一劳永逸的组件注册"><a href="#一劳永逸的组件注册" class="header-anchor">#</a> 一劳永逸的组件注册</h3> <div class="custom-block tip"><p class="custom-block-title">场景还原</p> <p>我们写了一堆基础UI组件，然后每次我们需要使用这些组件的时候，都得先import，然后声明components，很繁琐！秉持能偷懒就偷懒的原则，我们要想办法优化！</p></div> <blockquote><p>优化后</p></blockquote> <div class="custom-block tip"><p class="custom-block-title">注意</p> <p>我们需要借助一下神器webpack，使用 require.context() 方法来创建自己的（模块）上下文，从而实现自动动态require组件。这个方法需要3个参数：要搜索的文件夹目录，是否还应该搜索它的子目录，以及一个匹配文件的正则表达式。</p></div> <p>我们在components文件夹添加一个叫global.js的文件，在这个文件里借助webpack动态将需要的基础组件统统打包进来。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">function</span> <span class="token function">capitalizeFirstLetter</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> string<span class="token punctuation">.</span><span class="token function">chartAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> string<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//找到components文件夹下.vue文件</span>
<span class="token keyword">const</span> requireComponent <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token regex">/\.vue$/</span><span class="token punctuation">)</span>
requireComponent<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">filename</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 组件实例</span>
  <span class="token keyword">const</span> componentConfig <span class="token operator">=</span> <span class="token function">requireComponents</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
  <span class="token comment">// 组件名字</span>
  <span class="token keyword">const</span> componentName <span class="token operator">=</span> <span class="token function">capitalizeFirstLetter</span><span class="token punctuation">(</span>
    <span class="token comment">// 因为得到的filename格式是： ‘./baseButton.vue’, 所以这里我们去掉头和尾部，只保留真正的文件名</span>
    filename<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/^\.\//</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\.\w+$/</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token comment">// 组件挂载</span>
  Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>componentName<span class="token punctuation">,</span> componentConfig<span class="token punctuation">.</span>default <span class="token operator">||</span> componentConfig<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>最后我们在main.js中import 'components/global.js'，然后我们就可以随时随地使用这些基础组件，无需手动引入了。</p> <h3 id="无所不能的render函数"><a href="#无所不能的render函数" class="header-anchor">#</a> 无所不能的render函数</h3> <div class="custom-block tip"><p class="custom-block-title">场景还原</p> <p>vue要求每一个组件都只能有一个根元素，当你有多个根元素时，vue就会给你报错</p></div> <p><img src="https://lw68.top/blogs/assets/img/vue-op.1782c3c0.jpg" alt="截图"></p> <blockquote><p>那有没有办法化解呢，答案是有的，只不过这时候我们需要使用render()函数来创建HTML，而不是template。其实用js来生成html的好处就是极度的灵活功能强大，而且你不需要去学习使用vue的那些功能有限的指令API，比如v-for, v-if。（reactjs就完全丢弃了template）</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>functional<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">h<span class="token punctuation">,</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> props<span class="token punctuation">.</span>routes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">route</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>route<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>router<span class="token operator">-</span>link to<span class="token operator">=</span><span class="token punctuation">{</span>route<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>route<span class="token punctuation">.</span>title<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="无招胜有招的高阶组件"><a href="#无招胜有招的高阶组件" class="header-anchor">#</a> 无招胜有招的高阶组件</h3> <div class="custom-block tip"><p class="custom-block-title">场景还原</p> <p>划重点：这一招威力无穷，请务必掌握</p></div> <blockquote><p>当我们写组件的时候，父子组件的通信很重要。通常我们都需要从父组件传递一系列的props到子组件，同时父组件监听子组件emit过来的一系列事件。举例子：</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 父组件</span>
<span class="token operator">&lt;</span>BaseInput
  <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;value&quot;</span>
  label<span class="token operator">=</span><span class="token string">&quot;密码&quot;</span>
  placeholder<span class="token operator">=</span><span class="token string">&quot;请填写密码&quot;</span>
  @input<span class="token operator">=</span><span class="token string">&quot;handleInput&quot;</span>
  @focus<span class="token operator">=</span><span class="token string">&quot;handleFocus&quot;</span>
<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>BaseInput<span class="token operator">&gt;</span>
<span class="token comment">// 子组件</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>label<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span> label <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>input
      <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;value&quot;</span>
      <span class="token operator">:</span>placeholder<span class="token operator">=</span><span class="token string">&quot;placeholder&quot;</span>
      @input<span class="token operator">=</span><span class="token string">&quot;$emit('input', $event)&quot;</span>
      @focus<span class="token operator">=</span><span class="token string">&quot;$emit('focus', $event.target.value)&quot;</span>
    <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>有下面几个优化点：</p> <p>每一个从父组件传到子组件的props,我们都得在子组件的Props中显式的声明才能使用。这样一来，我们的子组件每次都需要申明一大堆props, 而类似placeholer这种dom原生的property我们其实完全可以直接从父传到子，无需声明。方法如下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>input
  <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;value&quot;</span>
  v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;$attrs&quot;</span>
  @input<span class="token operator">=</span><span class="token string">&quot;$emit('input', $event)&quot;</span>
<span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">注意</p> <p>$attrs包含了父作用域中不作为 prop 被识别 (且获取) 的特性绑定 (class 和 style 除外)。当一个组件没有声明任何 prop 时，这里会包含所有父作用域的绑定，并且可以通过v-bind=&quot;$attrs&quot; 传入内部组件——在创建更高层次的组件时非常有用。注意到子组件的@focus=$emit('focus', $event)&quot;其实什么都没做，只是把event传回给父组件而已，那其实和上面类似，我完全没必要显式地申明：</p></div> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>input
  <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;value&quot;</span>
  v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;$attrs&quot;</span>
  v<span class="token operator">-</span>on<span class="token operator">=</span><span class="token string">&quot;listeners&quot;</span>
<span class="token operator">/</span><span class="token operator">&gt;</span>

computed<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function">listeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>$listeners<span class="token punctuation">,</span>
      <span class="token function-variable function">input</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">注意</p> <p>$listeners包含了父作用域中的 (不含 .native 修饰器的) v-on 事件监听器。
它可以通过 v-on=&quot;$listeners&quot; 传入内部组件——在创建更高层次的组件时非常有用。</p></div> <div class="custom-block warning"><p class="custom-block-title">警告</p> <p>需要注意的是，由于我们input并不是BaseInput这个组件的根节点，而默认情况下父作用域的不被认作 props 的特性绑定将会“回退”且作为普通的 HTML 特性应用在子组件的根元素上。所以我们需要设置inheritAttrs:false，这些默认行为将会被去掉, 以上两点的优化才能成功。</p></div> <div class="gitalk-container"><div id="gitalk-container"></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/giserman001/blogs/edit/master/docs/vue/vue_optimize.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <!----> </main></div> <div id="money" class="animate" data-v-017e00a2><span data-v-017e00a2><img src="/blogs/images/nolook.svg" alt data-v-017e00a2></span> <em class="close" data-v-017e00a2></em> <div class="shadow" data-v-017e00a2></div> <ul data-v-017e00a2><li data-v-017e00a2><span data-v-017e00a2>支付宝扫一扫、领红包</span> <img src="/blogs/images/zf-s.jpg" data-v-017e00a2></li> <li data-v-017e00a2><span data-v-017e00a2>支持一杯coffee</span> <img src="/blogs/images/wx.jpg" data-v-017e00a2></li> <li data-v-017e00a2><span data-v-017e00a2>赏下百两黄金：</span> <img src="/blogs/images/zf.jpg" data-v-017e00a2></li></ul></div></div><div class="global-ui"><!----></div></div>
    <script src="https://lw68.top/blogs/assets/js/app.a89d5e58.js" defer></script><script src="https://lw68.top/blogs/assets/js/2.d82e790e.js" defer></script><script src="https://lw68.top/blogs/assets/js/24.0c4df642.js" defer></script><script src="https://lw68.top/blogs/assets/js/13.210d011a.js" defer></script>
  </body>
</html>
