(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{110:function(t,a,s){t.exports=s.p+"assets/img/jietu.39eff89f.png"},215:function(t,a,s){t.exports=s.p+"assets/img/jietu1.7e02459d.png"},216:function(t,a,s){t.exports=s.p+"assets/img/jietu2.5e48bd28.png"},217:function(t,a,s){t.exports=s.p+"assets/img/jietu3.694342df.png"},236:function(t,a,s){"use strict";s.r(a);var e=s(0),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h3",{attrs:{id:"关于vue-element-ui项目的分页，返回默认显示第一页的问题解决"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#关于vue-element-ui项目的分页，返回默认显示第一页的问题解决"}},[t._v("#")]),t._v(" 关于vue + element-ui项目的分页，返回默认显示第一页的问题解决")]),t._v(" "),e("blockquote",[e("p",[t._v("这个问题是自己开发过程中遇见，防止以后再次出现，所以记录下来。")])]),t._v(" "),e("blockquote",[e("p",[t._v("需求描述：在列表页面，点击分页按钮（列如点击到第三页），此时从列表进详情页面，再从详情返回上个列表页面，并且"),e("font",{attrs:{color:"#FF3030"}},[t._v("保持仍旧在第三页")])],1)]),t._v(" "),e("p",[t._v("如下截图：")]),t._v(" "),e("p",[t._v("当前页面如下")]),t._v(" "),e("p",[e("img",{attrs:{src:s(110),alt:"截图"}})]),t._v(" "),e("p",[t._v("然后点击页码跳到第3页，然后在第三页点击页面链接跳转到新的页面")]),t._v(" "),e("p",[e("img",{attrs:{src:s(215),alt:"截图"}}),t._v("\n然后在新页面点击返回按钮，返回到列表页，结果页面分页显示第一页，对应页面内容也是第一页")]),t._v(" "),e("p",[e("img",{attrs:{src:s(110),alt:"截图"}})]),t._v(" "),e("h3",{attrs:{id:"期望效果"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#期望效果"}},[t._v("#")]),t._v(" 期望效果")]),t._v(" "),e("p",[t._v("新页面返回的时候，页码和页面内容仍旧保持在跳转离开前的样子。")]),t._v(" "),e("h3",{attrs:{id:"解决办法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决办法"}},[t._v("#")]),t._v(" 解决办法")]),t._v(" "),e("h4",{attrs:{id:"利用localstorage或者sessionstorage将跳转页面前的currentpage存储起来，然后，再次返回当前页的时候，在created生命周期里，获取到存储的currentpage，再进行加载（理想很好，现实却很骨感）"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#利用localstorage或者sessionstorage将跳转页面前的currentpage存储起来，然后，再次返回当前页的时候，在created生命周期里，获取到存储的currentpage，再进行加载（理想很好，现实却很骨感）"}},[t._v("#")]),t._v(" 利用localStorage或者sessionStorage将跳转页面前的currentPage存储起来，然后，再次返回当前页的时候，在created生命周期里，获取到存储的currentPage，再进行加载（理想很好，现实却很骨感）")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("// 跳转详情 存当前页\ntoDetail "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index, row"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  storage.set"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pageNum'")]),t._v(", this.filter.pageNum"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  this."),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$router")]),t._v(".push"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("path: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/XXXX'")]),t._v(", query: "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("id: row.id, type: row.flowStatus.value"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n// 从localstorage取当前页\nasync "),e("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("mounted")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("storage.get"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pageNum'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    this.filter.pageNum "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" storage.get"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pageNum'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  // 请求列表数据\n  this.getList"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n")])])]),e("p",[t._v("这样，我们再返回当前页的时候，页面内容将会是跳转离开前的样子。")]),t._v(" "),e("p",[e("em",[e("strong",[t._v("但是至此工作仅仅完成一半，因为我们发现这个bug并没有完全解决")])]),t._v(" "),e("font",{attrs:{color:"#FF3030"}},[t._v("页面内容正确，页码高亮确认就是第一页")])],1),t._v(" "),e("h3",{attrs:{id:"问题造成原因"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#问题造成原因"}},[t._v("#")]),t._v(" 问题造成原因")]),t._v(" "),e("blockquote",[e("p",[t._v("我们返回当前页面取得总条数totalNum的之前，element-ui的分页组件已经在页面加载完毕，当时的totalNum绑定的是data里面初始化的数据0，所以当总条数为0的时候，分页组件的页码默认为1。并且当totalNum在created生命周期里取得数据后，分页组件也不会刷新。所以这就导致， "),e("em",[e("strong",[t._v("页面内容正确，但是页码高亮依旧是第一页")])])])]),t._v(" "),e("h3",{attrs:{id:"解决办法-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决办法-2"}},[t._v("#")]),t._v(" 解决办法")]),t._v(" "),e("p",[t._v("我们需要在created之后刷新这个分页组件或者让分页组件的html后于created之后加载到页面。\n再次刷新这个分页组件是不现实的，我们选择在created之后加载分页组件。具体办法就是使用v-if。在totalNum不为data里面给的初始值0的时候，才让这段html加载到页面。\n"),e("img",{attrs:{src:s(216),alt:"截图"}})]),t._v(" "),e("blockquote",[e("p",[t._v("然后再次测试，发现完美解决问题\n"),e("img",{attrs:{src:s(217),alt:"截图"}})])]),t._v(" "),e("h3",{attrs:{id:"后续："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#后续："}},[t._v("#")]),t._v(" 后续：")]),t._v(" "),e("p",[t._v("这里为什么用的是v-if而不是v-show。这就是每个vue初学者需要明白的事情了，就是v-if和v-show的区别。")])])}),[],!1,null,null,null);a.default=n.exports}}]);