(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{305:function(s,t,a){s.exports=a.p+"assets/img/egg.8966bd88.png"},306:function(s,t,a){s.exports=a.p+"assets/img/egg_file.361aa26b.png"},307:function(s,t,a){s.exports=a.p+"assets/img/egg_file1.f5035831.png"},308:function(s,t,a){s.exports=a.p+"assets/img/egg_flow.b4430cf6.jpg"},309:function(s,t,a){s.exports=a.p+"assets/img/egg_file2.1269b4af.png"},310:function(s,t,a){s.exports=a.p+"assets/img/egg-flow.81bf2937.png"},407:function(s,t,a){"use strict";a.r(t);var e=a(17),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"eggjs基本使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eggjs基本使用"}},[s._v("#")]),s._v(" EggJS基本使用")]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("记录")]),s._v(" "),e("p",[s._v("记录一下自己学习过程，方便以后自己查阅")])]),s._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#egg-js官网"}},[s._v("Egg.js官网")])]),e("li",[e("a",{attrs:{href:"#egg-js-是什么"}},[s._v("Egg.js  是什么?")])]),e("li",[e("a",{attrs:{href:"#egg-js-的特性："}},[s._v("Egg.js  的特性：")])]),e("li",[e("a",{attrs:{href:"#egg-js-在阿里的地位"}},[s._v("Egg.js  在阿里的地位")])]),e("li",[e("a",{attrs:{href:"#egg-js发展历程"}},[s._v("Egg.js发展历程")])]),e("li",[e("a",{attrs:{href:"#egg-js-目录结构介绍"}},[s._v("Egg.js  目录结构介绍")])]),e("li",[e("a",{attrs:{href:"#egg-js目录约定规范"}},[s._v("Egg.js目录约定规范")])]),e("li",[e("a",{attrs:{href:"#vscode-egg-开发工具配置"}},[s._v("Vscode+Egg  开发工具配置")])]),e("li",[e("a",{attrs:{href:"#egg-路由配置"}},[s._v("Egg 路由配置")])]),e("li",[e("a",{attrs:{href:"#取获取-get-传值以及动态路由的值"}},[s._v("取获取 Get  传值以及动态路由的值")])]),e("li",[e("a",{attrs:{href:"#egg-view-ejs-的使用"}},[s._v("egg-view-ejs  的使用")])]),e("li",[e("a",{attrs:{href:"#服务-service-和控制器-controller-相互调用规则"}},[s._v("服务(service)和控制器(controller)相互调用规则")])]),e("li",[e("a",{attrs:{href:"#egg-制-安全机制-csrf-的防范"}},[s._v("Egg 制 安全机制 CSRF  的防范")])]),e("li",[e("a",{attrs:{href:"#egg-post-提交数据"}},[s._v("Egg Post  提交数据")])]),e("li",[e("a",{attrs:{href:"#获取数据-egg-js-获取数据不需要配置中间件直接通过下面方式获取"}},[s._v("获取数据(egg.js 获取数据不需要配置中间件直接通过下面方式获取)")])]),e("li",[e("a",{attrs:{href:"#获取-csrf"}},[s._v("获取 csrf")])]),e("li",[e("a",{attrs:{href:"#egg-配置模板全局变量"}},[s._v("Egg  配置模板全局变量")])]),e("li",[e("a",{attrs:{href:"#eggjs-cookie-简介"}},[s._v("Eggjs ----- Cookie  简介")])]),e("li",[e("a",{attrs:{href:"#egg-js-中cookie"}},[s._v("Egg.js 中Cookie")])]),e("li",[e("a",{attrs:{href:"#egg-js-中cookie参数options"}},[s._v("Egg.js 中Cookie参数options")])]),e("li",[e("a",{attrs:{href:"#egg-js-中设置中文-cookie"}},[s._v("Egg.js  中设置中文 Cookie")])]),e("li",[e("a",{attrs:{href:"#eggjs-中session"}},[s._v("Eggjs ---- 中Session")])]),e("li",[e("a",{attrs:{href:"#session-工作流"}},[s._v("Session 工作流")])]),e("li",[e("a",{attrs:{href:"#egg-js-中session-的使用"}},[s._v("Egg.js 中session 的使用")])]),e("li",[e("a",{attrs:{href:"#session-在config-default-js"}},[s._v("Session 在config.default.js")])]),e("li",[e("a",{attrs:{href:"#cookie-和-和-session"}},[s._v("Cookie 和 和 Session")])])])]),e("p"),s._v(" "),e("h3",{attrs:{id:"egg-js官网"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-js官网"}},[s._v("#")]),s._v(" Egg.js官网")]),s._v(" "),e("p",[s._v("官网： https://eggjs.org")]),s._v(" "),e("p",[s._v("中文网站: https://eggjs.org/zh-cn/")]),s._v(" "),e("h3",{attrs:{id:"egg-js-是什么"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-js-是什么"}},[s._v("#")]),s._v(" Egg.js  是什么?")]),s._v(" "),e("p",[s._v("Egg.js 是《阿里旗下产品》基于 Node.js 和 Koa 是一个 Nodejs 的企业级应用开发框架。\n可以帮助发团队和开发人员降低开发和维护成本。\nExpress 和 Koa 是 Node.js 社区广泛使用的框架，简单且扩展性强，非常适合做个人项\n目。但框架本身缺少约定，标准的 MVC 模型会有各种千奇百怪的写法。Egg 按照约定进行\n开发，奉行『约定优于配置』，团队协作成本低。\nEgg.js 基于 Es6、Es7 以及 Typescript、Koa2 使得 Nodejs 具有更规范的开发模式、更低\n的学习成本、更优雅的代码、更少的开发成本、更少的维护成本。")]),s._v(" "),e("h3",{attrs:{id:"egg-js-的特性："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-js-的特性："}},[s._v("#")]),s._v(" Egg.js  的特性：")]),s._v(" "),e("ol",[e("li",[s._v("提供基于 Egg 定制上层框架的能力")]),s._v(" "),e("li",[s._v("高度可扩展的插件机制")]),s._v(" "),e("li",[s._v("内置多进程管理")]),s._v(" "),e("li",[s._v("基于 Koa 开发，性能优异")]),s._v(" "),e("li",[s._v("框架稳定，测试覆盖率高")]),s._v(" "),e("li",[s._v("渐进式开发")])]),s._v(" "),e("h3",{attrs:{id:"egg-js-在阿里的地位"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-js-在阿里的地位"}},[s._v("#")]),s._v(" Egg.js  在阿里的地位")]),s._v(" "),e("p",[e("img",{attrs:{src:a(305),alt:"截图"}})]),s._v(" "),e("h3",{attrs:{id:"egg-js发展历程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-js发展历程"}},[s._v("#")]),s._v(" Egg.js发展历程")]),s._v(" "),e("ol",[e("li",[s._v("2013 年蚂蚁的 chair 框架，可以视为 egg 的前身。")]),s._v(" "),e("li",[s._v("2015 年 11 月，在苏千的召集下，阿里各 BU 的前端骨干齐聚黄龙，闭门共建。")]),s._v(" "),e("li",[s._v("2016 年初，各 BU 的基础 web 框架完成升级，在同一套规范的基础上进行差异化定制。")]),s._v(" "),e("li",[s._v("2016 年中，广泛使用在绝大部分阿里的前端 Node.js 应用。")]),s._v(" "),e("li",[s._v("2016 年 09 月，在 JSConf China 2016 上亮相并宣布开源。")]),s._v(" "),e("li",[s._v("2017 年初，官网文档 egg - 为企业级框架和应用而生 亮相，并将在本月发布 egg@1.0版本。")]),s._v(" "),e("li",[s._v("2017 年 12 月左右 Egg 社区版 2.0 正式发布，性能提升 30%，基于 koa2 拥抱 Async")]),s._v(" "),e("li",[s._v("2018 年 7 月最新 egg 的版本是 2.2.1")])]),s._v(" "),e("p",[s._v("经过几年的沉淀 Egg 已经非常成熟。")]),s._v(" "),e("h3",{attrs:{id:"egg-js-目录结构介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-js-目录结构介绍"}},[s._v("#")]),s._v(" Egg.js  目录结构介绍")]),s._v(" "),e("p",[e("img",{attrs:{src:a(306),alt:"截图"}})]),s._v(" "),e("h3",{attrs:{id:"egg-js目录约定规范"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-js目录约定规范"}},[s._v("#")]),s._v(" Egg.js目录约定规范")]),s._v(" "),e("p",[e("img",{attrs:{src:a(307),alt:"截图"}})]),s._v(" "),e("p",[s._v("egg工作流")]),s._v(" "),e("p",[e("img",{attrs:{src:a(308),alt:"截图"}})]),s._v(" "),e("h3",{attrs:{id:"vscode-egg-开发工具配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vscode-egg-开发工具配置"}},[s._v("#")]),s._v(" Vscode+Egg  开发工具配置")]),s._v(" "),e("p",[e("img",{attrs:{src:a(309),alt:"截图"}})]),s._v(" "),e("h3",{attrs:{id:"egg-路由配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-路由配置"}},[s._v("#")]),s._v(" Egg 路由配置")]),s._v(" "),e("p",[s._v("https://eggjs.org/zh-cn/basics/router.html")]),s._v(" "),e("h3",{attrs:{id:"取获取-get-传值以及动态路由的值"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#取获取-get-传值以及动态路由的值"}},[s._v("#")]),s._v(" 取获取 Get  传值以及动态路由的值")]),s._v(" "),e("p",[s._v("https://eggjs.org/zh-cn/basics/controller.html")]),s._v(" "),e("h3",{attrs:{id:"egg-view-ejs-的使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-view-ejs-的使用"}},[s._v("#")]),s._v(" egg-view-ejs  的使用")]),s._v(" "),e("p",[s._v("https://github.com/eggjs/egg-view-ejs")]),s._v(" "),e("ol",[e("li",[s._v("安装")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("npm i egg"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("view"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ejs "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("save\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("找到 {app_root}/config/plugin.js")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("exports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ejs "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  enable"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'egg-view-ejs'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("找到 {app_root}/config/config.default.js")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("exports")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("appInfo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" config "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" exports "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// use for cookie sign key, should change to your own and keep security")]),s._v("\n  config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("keys "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" appInfo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'_1532498393023_7447'")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// add your config here")]),s._v("\n  config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("middleware "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//配置 ejs 模板引擎")]),s._v("\n  config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("view "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    mapping"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.html'")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ejs'")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" config\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("h3",{attrs:{id:"服务-service-和控制器-controller-相互调用规则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#服务-service-和控制器-controller-相互调用规则"}},[s._v("#")]),s._v(" 服务(service)和控制器(controller)相互调用规则")]),s._v(" "),e("p",[e("img",{attrs:{src:a(310),alt:"截图"}})]),s._v(" "),e("h3",{attrs:{id:"egg-制-安全机制-csrf-的防范"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-制-安全机制-csrf-的防范"}},[s._v("#")]),s._v(" Egg 制 安全机制 CSRF  的防范")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://eggjs.org/zh-cn/core/security.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://eggjs.org/zh-cn/core/security.html"),e("OutboundLink")],1)]),s._v(" "),e("h3",{attrs:{id:"egg-post-提交数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-post-提交数据"}},[s._v("#")]),s._v(" Egg Post  提交数据")]),s._v(" "),e("blockquote",[e("p",[s._v("第一种post提交数据")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("form action"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/news/doAdd?_csrf=<%=csrf%> "')]),s._v(" method"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"POST"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  用户名"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("input type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(" name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("br"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("br"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  密 码"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("input type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(" name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),s._v(" type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("button type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"submit"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("提交"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("button"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("form"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("blockquote",[e("p",[s._v("第二种post提交数据")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("form action"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/news/doAdd"')]),s._v(" method"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"POST"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("input type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hidden"')]),s._v(" name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_csrf"')]),s._v(" value"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<%=csrf%>"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  用户名"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("input type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(" name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("br"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("br"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  密 码"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("input type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(" name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),s._v(" type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("button type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"submit"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("提交"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("button"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("form"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"获取数据-egg-js-获取数据不需要配置中间件直接通过下面方式获取"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取数据-egg-js-获取数据不需要配置中间件直接通过下面方式获取"}},[s._v("#")]),s._v(" 获取数据(egg.js 获取数据不需要配置中间件直接通过下面方式获取)")]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("request"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"获取-csrf"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取-csrf"}},[s._v("#")]),s._v(" 获取 csrf")]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("csrf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"egg-配置模板全局变量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-配置模板全局变量"}},[s._v("#")]),s._v(" Egg  配置模板全局变量")]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("state"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("csrf"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("csrf"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置全局变量")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"eggjs-cookie-简介"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eggjs-cookie-简介"}},[s._v("#")]),s._v(" Eggjs ----- Cookie  简介")]),s._v(" "),e("ol",[e("li",[s._v("cookie 是存储于访问者的计算机中的变量。可以让我们用同一个浏览器访问同一个域名的时候共享数据。")]),s._v(" "),e("li",[s._v("HTTP 是无状态协议。简单地说，当你浏览了一个页面，然后转到同一个网站的另一个页面，服务器无法认识到这是同一个浏览器在访问同一个网站。每一次的访问，都是没有任何关系的。")])]),s._v(" "),e("h3",{attrs:{id:"egg-js-中cookie"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-js-中cookie"}},[s._v("#")]),s._v(" Egg.js 中Cookie")]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("语法")]),s._v(" "),e("p",[s._v("Cookie  设置语法： ctx.cookies.set(key, value, options)")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cookies"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'zhangsan'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("语法")]),s._v(" "),e("p",[s._v("Cookie  获取语法：ctx.cookies.get(key, options)")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cookies"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("::: 语法\nCookie  清除语法：ctx.cookies.set(key, null, options)\n或者设置 maxAge 过期时间为 0\n:::")]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cookies"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"egg-js-中cookie参数options"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-js-中cookie参数options"}},[s._v("#")]),s._v(" Egg.js 中Cookie参数options")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://eggjs.org/zh-cn/core/cookie-and-session.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://eggjs.org/zh-cn/core/cookie-and-session.html"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("建议")]),s._v(" "),e("p",[s._v("设置 cookie  建议的写法如下")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cookies"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  maxAge"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  httpOnly"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// by default it's true")]),s._v("\n  encrypt"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// cookies are encrypted during network transmission")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cookies"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'frontend-cookie'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  encrypt"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"egg-js-中设置中文-cookie"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-js-中设置中文-cookie"}},[s._v("#")]),s._v(" Egg.js  中设置中文 Cookie")]),s._v(" "),e("ol",[e("li",[s._v("第一种解决方案：")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Buffer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello, world!'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'base64'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 转换成 base64 字符串：aGVsbG8sIHdvcmxkIQ==")]),s._v("\nconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Buffer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'aGVsbG8sIHdvcmxkIQ=='")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'base64'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 还原 base64 字符串：hello, world!")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("第二种解决方案：")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cookies"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  maxAge"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  httpOnly"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// by default it's true")]),s._v("\n  encrypt"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// cookies are encrypted during network transmission")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"eggjs-中session"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eggjs-中session"}},[s._v("#")]),s._v(" Eggjs ---- 中Session")]),s._v(" "),e("p",[s._v("session 是另一种记录客户状态的机制，不同的是 Cookie 保存在客户端浏览器中，而session 保存在服务器上")]),s._v(" "),e("h3",{attrs:{id:"session-工作流"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#session-工作流"}},[s._v("#")]),s._v(" Session 工作流")]),s._v(" "),e("p",[s._v("当浏览器访问服务器并发送第一次请求时，服务器端会创建一个 session 对象，生成一个类似于 key,value 的键值对， 然后将 key(cookie)返回到浏览器(客户)端，浏览器下次再访问时，携带 key(cookie)，找到对应的 session(value)。")]),s._v(" "),e("h3",{attrs:{id:"egg-js-中session-的使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#egg-js-中session-的使用"}},[s._v("#")]),s._v(" Egg.js 中session 的使用")]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),e("p",[s._v("egg.js 中 session 基于 egg-session 内置了对 session 的操作")])]),s._v(" "),e("ol",[e("li",[s._v("设置")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("userinfo"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'张三'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  age"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'20'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("获取")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" userinfo"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("Session  的默认设置")])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("exports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  key"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'EGG_SESS'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  maxAge"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1 day")]),s._v("\n  httpOnly"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  encrypt"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"session-在config-default-js"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#session-在config-default-js"}},[s._v("#")]),s._v(" Session 在config.default.js")]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  key"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'SESSION_ID'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  maxAge"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("864000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  renew"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//延长会话有效期")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"cookie-和-和-session"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cookie-和-和-session"}},[s._v("#")]),s._v(" Cookie 和 和 Session")]),s._v(" "),e("ol",[e("li",[s._v("cookie 数据存放在客户的浏览器上，session 数据放在服务器上。")]),s._v(" "),e("li",[s._v("cookie 相比 session 没有 session 安全，别人可以分析存放在本地的 COOKIE 并进行 COOKIE欺骗。")]),s._v(" "),e("li",[s._v("session 会在一定时间内保存在服务器上。当访问增多，会比较占用你服务器的性能考虑到减轻服务器性能方面，应当使用 COOKIE。")]),s._v(" "),e("li",[s._v("单个 cookie 保存的数据不能超过 4K，很多浏览器都限制一个站点最多保存 20 个 cookie。")])]),s._v(" "),e("comment-comment")],1)}),[],!1,null,null,null);t.default=n.exports}}]);